%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% njuthesis 示例模板 v1.4.2 2024-11-08
% https://github.com/nju-lug/NJUThesis
%
% 贡献者
% Yu XIONG @atxy-blip   Yichen ZHAO @FengChendian
% Song GAO @myandeg     Chang MA @glatavento
% Yilun SUN @HermitSun  Yinfeng LIN @linyinfeng
% Yukai Chou @Muzimuzhi
%
% 许可证
% LaTeX Project Public License（版本 1.3c 或更高）
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%---------------------------------------------------------------------
% 一些提升使用体验的小技巧：
%   1. 请务必使用 UTF-8 编码编写和保存本文档
%   2. 请务必使用 XeLaTeX 或 LuaLaTeX 引擎进行编译
%   3. 不保证接口稳定，写作前一定要留意版本号
%   4. 以百分号(%)开头的内容为注释，可以随意删除
%---------------------------------------------------------------------

%---------------------------------------------------------------------
% 请先阅读使用手册：
% http://mirrors.ctan.org/macros/unicodetex/latex/njuthesis/njuthesis.pdf
%---------------------------------------------------------------------

\PassOptionsToPackage{%%%%%%%%%%%%%%%%%%%%%%%
	backref=true,
	}{biblatex}%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[
    % 模板选项(注意右端逗号)：
    %
    type = doctor,
    % type = bachelor|master|doctor|postdoc, % 文档类型，默认为本科生
    % degree = academic|professional,        % 学位类型，默认为学术型
    %
    % nl-cover,   % 是否需要国家图书馆封面，默认关闭
    % decl-page,  % 是否需要诚信承诺书或原创性声明，默认关闭
    %
    %   页面模式，详见手册说明
    % draft,                  % 开启草稿模式
    % anonymous,              % 开启盲审模式
    % minimal,                % 开启最小化模式
    %
    %   单双面模式，默认为适合印刷的双面模式
    % oneside,                % 单面模式，无空白页
    % twoside,                % 双面模式，每一章从奇数页开始
    %
    %   字体设置，不填写则自动调用系统预装字体，详见手册
    % fontset = win|mac|macoffice|fandol|none,
    % latin-font = win|mac|gyre|none,
    % cjk-font   = win|mac|fandol|founder|noto|source|none,
    % math-font  = cambria|newcm|xits, % 完整列表见手册
%    biblatex = false,
%    unicode-math = false,
  ]{njuthesis}

% 模板选项设置，包括个人信息、外观样式等
% 较为冗长且一般不需要反复修改，我们把它放在单独的文件里
\input{njuthesis-setup.def}

\njusetformat{chapter}{\raggedleft\kaishu\zihao{-1}}

% 自行载入所需宏包
% \usepackage{subcaption} % 嵌套小幅图像，比 subfig 和 subfigure 更新更好
% \usepackage{siunitx} % 标准单位符号
\usepackage{physics} % 物理百宝箱
% \usepackage[version=4]{mhchem} % 绘制分子式
% \usepackage{listings} % 展示代码
% \usepackage{algorithm,algorithmic} % 展示算法伪代码

%%%%%%%%%%%%%%%%%%%%%%% my packages
\usepackage{hyperref} % 只读的 njuthesis.cls 中，已经用 RequirePackage 定义了
\usepackage{cases}
\usepackage{accents}
\usepackage{xeCJKfntef}
\usepackage{stmaryrd}
\usepackage{esvect}
\usepackage{fontspec,xunicode-addon} % fontspec 需要 XeLaTeX；xunicode-addon 带圈数字
\usepackage{graphicx}  % resize 表格的宽度 不超过文本宽度
\usepackage{booktabs}  % 经典三线表 \toprule、\midrule、\bottomrule
\usepackage{cancel}

%\usepackage{amsmath,amssymb,amsfonts}%
%\usepackage{amsthm}%
%\usepackage{mathrsfs}%
%\usepackage[title]{appendix}%
%\usepackage[table,dvipsnames]{xcolor}% [dvipsnames] for custom .sty;
\usepackage{tikzsetup}
% -------------------- currently these custom packages are coupled together, sharing some public \cmds, so the package below may rely on the one above
\usepackage{secbacklinktoc}% custom .sty
\usepackage{optsection}% custom .sty
%\usepackage{tocformat}% custom .sty
\usepackage{apptoc}% custom .sty
\usepackage{bibbackref}% custom .sty
\usepackage{amseqfloatbackref}% custom .sty
\usepackage{footnotebacklink}% custom .sty

% 在导言区随意定制所需命令
% \DeclareMathOperator{\spn}{span}
% \NewDocumentCommand\mathbi{m}{\textbf{\em #1}}

%%%%%%%%%%%%%%%%%%%%%%% my commands
\makeatletter
\def\ubar{\underaccent{{\underline{\mskip10mu}}}}
\def\uddot{\underaccent{\"}} % 选这个 还是选 \undertilde{} ← 这个类似 underline
\makeatother

\def\sf{\fontspec{Lato-Italic.ttf}} % \text{\sf g}
\setmathtt{Arial Italic} % 需要 \usepackage{fontspec}（现在已经用 isomath 来替代）

\allowdisplaybreaks[4] % 允许 align 环境自动跨页
\ctexset{
	chapter = {
		%		format={\centering\sffamily},
		%		nameformat={\heiti\zihao{3}},
		%		titleformat={\heiti \zihao {3}},
		%		numberformat={\heiti \zihao {3}},
		beforeskip={0pt},afterskip={36pt},
		%		name={第, 章},number={\arabic {chapter}}
	},
	section = {
		%		format={\flushleft \sffamily \heiti \zihao {4}},
		beforeskip={40pt},afterskip={16pt},
	},
	subsection = {
		%		format={\flushleft\sffamily\heiti\zihao{-4}},
		beforeskip={24pt},afterskip={16pt},
	},   
	subsubsection = {
		%		format={\flushleft\sffamily\heiti\zihao{-4}},
		beforeskip={24pt},afterskip={16pt},
}}

%% ------------------------------------------------
% XeLaTeX 下需要把全体带圈数字都设置成 Default 类
% LuaLaTeX 下无须额外设置
\xeCJKDeclareCharClass{Default}{"24EA, "2460->"2473, "3251->"32BF}

% 将中文字体声明为（西文）字体族
\newfontfamily\EnclosedNumbers{Source Han Serif SC}

% 放置钩子，只让带圈字符才需更换字体
\AtBeginUTFCommand[\textcircled]{\begingroup\EnclosedNumbers}
\AtEndUTFCommand[\textcircled]{\endgroup}

%% ------------------------------------------------
% 为设置 无衬线反白（negative circled sans-serif digits） 而设置字体
\newfontfamily{\SHSC}{Source Han Serif SC}
%\def\negacircled#1{\SHSC \symbol{"#1}}
\def\zero{\SHSC \symbol{"24FF}}
\def\one{\SHSC \symbol{"2776}}
\def\two{\SHSC \symbol{"2777}}
\def\three{\SHSC \symbol{"2778}}
\def\four{\SHSC \symbol{"2779}}
\def\five{\SHSC \symbol{"277A}}
\def\six{\SHSC \symbol{"277B}}
\def\seven{\SHSC \symbol{"277C}}
\def\eight{\SHSC \symbol{"277D}}
\def\nine{\SHSC \symbol{"277E}}
\def\ten{\SHSC \symbol{"277F}}

% 开始编写论文
\begin{document}



%---------------------------------------------------------------------
%	封面、摘要、前言和目录
%---------------------------------------------------------------------

% 生成封面页
\maketitle

% 模板默认使用 \flushbottom，即底部平齐
% 效果更好，但可能出现 underfull \vbox 信息
% 以下命令用于抑制这些信息
% \raggedbottom

\begin{abstract}
  中文摘要
\end{abstract}

\begin{abstract*}
  English abstract
\end{abstract*}

% 生成目录
\tableofcontents
% 生成图片清单
% \listoffigures
% 生成表格清单
% \listoftables

%---------------------------------------------------------------------
%	正文部分
%---------------------------------------------------------------------
\mainmatter

% 符号表
% 语法与 description 环境一致
% 两个可选参数依次为说明区域宽度、符号区域宽度
% 带星号的符号表(notation*)不会插入目录
% \begin{notation}[10cm]
%   \item[DFT] 密度泛函理论 (Density functional theory)
%   \item[DMRG] 密度矩阵重正化群 (Density-Matrix Reformation-Group)
% \end{notation}

% 建议将论文内容拆分为多个文件
% 即新建一个 chapters 文件夹
% 把每一章的内容单独放入一个 .tex 文件
% 然后在这里用 \include 导入，例如
%   \include{chapters/introduction}
%   \include{chapters/environments}
\include{./chapters/chapter1.tex}
\include{./chapters/chapter2.tex}

%---------------------------------------------------------------------
%	参考文献
%---------------------------------------------------------------------

% 生成参考文献页
\printbibliography

%---------------------------------------------------------------------
%	致谢
%---------------------------------------------------------------------

\begin{acknowledgement}
  感谢 \href{https://git.nju.edu.cn/nju-lug/lug-introduction}{LUG@NJU}。
\end{acknowledgement}

%---------------------------------------------------------------------
%	学术简历
%---------------------------------------------------------------------

% 详见手册中“成果列表”一节
% \njuchapter{学术成果}
% \njupaperlist[攻读博士学位期间发表的学术论文]{preskill2018}

%---------------------------------------------------------------------
%	附录部分
%---------------------------------------------------------------------

% 附录部分使用单独的字母序号
\appendix
\let\appthechapter\thechapter% for secbacklinktoc .sty
\let\appthesection\thesection% for secbacklinktoc .sty
\let\appthesubsection\thesubsection% for secbacklinktoc .sty
\let\appthesubsubsection\thesubsubsection% for secbacklinktoc .sty
\counterwithin{figure}{section} % for custom .sty
\counterwithin{table}{section}% for custom .sty

% 可以在这里插入补充材料
\appchapter{正文中涉及的数据及源代码}

\appsection{test}

\appsubsection{ddddd}

\dots

% 完工
\end{document}
